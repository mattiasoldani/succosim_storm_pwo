#include "Bremsstrahlungcorrection.hh"

BremsstrahlungCorrection::BremsstrahlungCorrection()
{
axis=PWO_100; // PWO_001/PWO_100 - edited by Mattia
}
void BremsstrahlungCorrection::set_axis(axis_material a)
{
    axis=a;
}

G4double  BremsstrahlungCorrection::ComputeCorrection(G4double eKineticEnergy)
{
    switch (static_cast<int>(axis)) {
    case PWO:
    return ComputeCorrectionPWO(eKineticEnergy);
    case W111:
    break;
    case PWO_001:
    return ComputeCorrectionPWO_001(eKineticEnergy);
    case PWO_100: // added by Mattia
    return ComputeCorrectionPWO_100(eKineticEnergy); // added by Mattia
    case W111_electron:
        return ComputeCorrectionW_111_electron(eKineticEnergy);
    break;
    case W111_positron:
        return ComputeCorrectionW_111_positron(eKineticEnergy);
    break;
    case W111_3mrad_electron:
        return ComputeCorrectionW_111_3mrad_electron(eKineticEnergy);
    break;
    case W111_3mrad_positron:
        return ComputeCorrectionW_111_3mrad_positron(eKineticEnergy);
    break;
    default:
        printf("\nWrong type of axis and material %d.\n", axis);
        return 1;
    };
}

G4double BremsstrahlungCorrection::ComputeCorrectionPWO(G4double eKineticEnergy)
{

    //calculate correction for cross section
    //  approximation from 0 to 1 TeV  by  polynomial
    G4double value=1;
    G4double energyG;

    energyG=eKineticEnergy/GeV;
    if(energyG<5)
    {
       value=1.0 + 0.075 *energyG + 0.025*energyG*energyG;
    }
    else
    {
        if(energyG<20)
        {
            value=1.016 + 0.2042*energyG - 0.00148*energyG*energyG ;
        }
        else
        {
            if(energyG<60)
            {
                value=1.145 + 0.248617*energyG - 0.00462*energyG*energyG + 0.0000298333*energyG*energyG*energyG ;
            }
            else
            {
                if(energyG<150)
                {
                    value=1.42824 + 0.128068*energyG - 0.00108813*energyG*energyG + 3.14325e-6*energyG*energyG*energyG;
                }
                else
                {
                    if(energyG<400)
                    {
                        value=6.408 + 0.00170583*energyG + 6.675e-6*energyG*energyG - 1.48333e-8*energyG*energyG*energyG;
                    }
                    else
                    {
                        value=5.67375 + 0.00751086*energyG - 0.0000114588*energyG*energyG + 5.69229e-9*energyG*energyG*energyG;
                    }
                }
            }
        }
    }
    return value;
}

// edited by Mattia ///////////////////////////////////////
G4double BremsstrahlungCorrection::ComputeCorrectionPWO_001(G4double eKineticEnergy)
{

    //calculate correction for cross section
    //  approximation from 0 to 1 TeV  by  polynomial
    G4double value=1;
    G4double energyG;

    energyG=eKineticEnergy/GeV;
	
	if (energyG<1.0){value=1.036010;}
	else if ((energyG>=1.00000000000000)&&(energyG<2.12999999523163)){value=((1.540826-1.036010)/(2.12999999523163-1.00000000000000))*energyG + (1.540826-((1.540826-1.036010)/(2.12999999523163-1.00000000000000))*2.12999999523163);}
	else if ((energyG>=2.12999999523163)&&(energyG<3.40689998445511)){value=((1.896726-1.540826)/(3.40689998445511-2.12999999523163))*energyG + (1.896726-((1.896726-1.540826)/(3.40689998445511-2.12999999523163))*3.40689998445511);}
	else if ((energyG>=3.40689998445511)&&(energyG<4.84979696618891)){value=((2.206389-1.896726)/(4.84979696618891-3.40689998445511))*energyG + (2.206389-((2.206389-1.896726)/(4.84979696618891-3.40689998445511))*4.84979696618891);}
	else if ((energyG>=4.84979696618891)&&(energyG<6.48027054866783)){value=((2.348222-2.206389)/(6.48027054866783-4.84979696618891))*energyG + (2.348222-((2.348222-2.206389)/(6.48027054866783-4.84979696618891))*6.48027054866783);}
	else if ((energyG>=6.48027054866783)&&(energyG<8.32270568909431)){value=((2.645966-2.348222)/(8.32270568909431-6.48027054866783))*energyG + (2.645966-((2.645966-2.348222)/(8.32270568909431-6.48027054866783))*8.32270568909431);}
	else if ((energyG>=8.32270568909431)&&(energyG<10.4046573889908)){value=((2.778921-2.645966)/(10.4046573889908-8.32270568909431))*energyG + (2.778921-((2.778921-2.645966)/(10.4046573889908-8.32270568909431))*10.4046573889908);}
	else if ((energyG>=10.4046573889908)&&(energyG<12.7572627999464)){value=((2.945653-2.778921)/(12.7572627999464-10.4046573889908))*energyG + (2.945653-((2.945653-2.778921)/(12.7572627999464-10.4046573889908))*12.7572627999464);}
	else if ((energyG>=12.7572627999464)&&(energyG<15.4157069031080)){value=((3.112466-2.945653)/(15.4157069031080-12.7572627999464))*energyG + (3.112466-((3.112466-2.945653)/(15.4157069031080-12.7572627999464))*15.4157069031080);}
	else if ((energyG>=15.4157069031080)&&(energyG<18.4197487270042)){value=((3.210993-3.112466)/(18.4197487270042-15.4157069031080))*energyG + (3.210993-((3.210993-3.112466)/(18.4197487270042-15.4157069031080))*18.4197487270042);}
	else if ((energyG>=18.4197487270042)&&(energyG<21.8143159736826)){value=((3.232092-3.210993)/(21.8143159736826-18.4197487270042))*energyG + (3.232092-((3.232092-3.210993)/(21.8143159736826-18.4197487270042))*21.8143159736826);}
	else if ((energyG>=21.8143159736826)&&(energyG<25.6501769462425)){value=((3.310596-3.232092)/(25.6501769462425-21.8143159736826))*energyG + (3.310596-((3.310596-3.232092)/(25.6501769462425-21.8143159736826))*25.6501769462425);}
	else if ((energyG>=25.6501769462425)&&(energyG<29.9846998269445)){value=((3.476773-3.310596)/(29.9846998269445-25.6501769462425))*energyG + (3.476773-((3.476773-3.310596)/(29.9846998269445-25.6501769462425))*29.9846998269445);}
	else if ((energyG>=29.9846998269445)&&(energyG<34.8827106614691)){value=((3.560094-3.476773)/(34.8827106614691-29.9846998269445))*energyG + (3.560094-((3.560094-3.476773)/(34.8827106614691-29.9846998269445))*34.8827106614691);}
	else if ((energyG>=34.8827106614691)&&(energyG<40.4174628811264)){value=((3.669039-3.560094)/(40.4174628811264-34.8827106614691))*energyG + (3.669039-((3.669039-3.560094)/(40.4174628811264-34.8827106614691))*40.4174628811264);}
	else if ((energyG>=40.4174628811264)&&(energyG<46.6717328629473)){value=((3.643452-3.669039)/(46.6717328629473-40.4174628811264))*energyG + (3.643452-((3.643452-3.669039)/(46.6717328629473-40.4174628811264))*46.6717328629473);}
	else if ((energyG>=46.6717328629473)&&(energyG<53.7390579125823)){value=((3.798937-3.643452)/(53.7390579125823-46.6717328629473))*energyG + (3.798937-((3.798937-3.643452)/(53.7390579125823-46.6717328629473))*53.7390579125823);}
	else if ((energyG>=53.7390579125823)&&(energyG<61.7251351849702)){value=((3.711026-3.798937)/(61.7251351849702-53.7390579125823))*energyG + (3.711026-((3.711026-3.798937)/(61.7251351849702-53.7390579125823))*61.7251351849702);}
	else if ((energyG>=61.7251351849702)&&(energyG<70.7494024646879)){value=((3.913106-3.711026)/(70.7494024646879-61.7251351849702))*energyG + (3.913106-((3.913106-3.711026)/(70.7494024646879-61.7251351849702))*70.7494024646879);}
	else if ((energyG>=70.7494024646879)&&(energyG<80.9468244477379)){value=((3.815003-3.913106)/(80.9468244477379-70.7494024646879))*energyG + (3.815003-((3.815003-3.913106)/(80.9468244477379-70.7494024646879))*80.9468244477379);}
	else if ((energyG>=80.9468244477379)&&(energyG<92.4699112399593)){value=((3.960642-3.815003)/(92.4699112399593-80.9468244477379))*energyG + (3.960642-((3.960642-3.815003)/(92.4699112399593-80.9468244477379))*92.4699112399593);}
	else if ((energyG>=92.4699112399593)&&(energyG<105.490999260223)){value=((3.902379-3.960642)/(105.490999260223-92.4699112399593))*energyG + (3.902379-((3.902379-3.960642)/(105.490999260223-92.4699112399593))*105.490999260223);}
	else if ((energyG>=105.490999260223)&&(energyG<120.204828661032)){value=((3.916359-3.902379)/(120.204828661032-105.490999260223))*energyG + (3.916359-((3.916359-3.902379)/(120.204828661032-105.490999260223))*120.204828661032);}
	else if ((energyG>=120.204828661032)&&(energyG<136.831455813785)){value=((4.032647-3.916359)/(136.831455813785-120.204828661032))*energyG + (4.032647-((4.032647-3.916359)/(136.831455813785-120.204828661032))*136.831455813785);}
	else if ((energyG>=136.831455813785)&&(energyG<155.619544417114)){value=((3.881427-4.032647)/(155.619544417114-136.831455813785))*energyG + (3.881427-((3.881427-4.032647)/(155.619544417114-136.831455813785))*155.619544417114);}
	else if ((energyG>=155.619544417114)&&(energyG<176.850084449286)){value=((4.020509-3.881427)/(176.850084449286-155.619544417114))*energyG + (4.020509-((4.020509-3.881427)/(176.850084449286-155.619544417114))*176.850084449286);}
	else if ((energyG>=176.850084449286)&&(energyG<200.840594584407)){value=((3.979703-4.020509)/(200.840594584407-176.850084449286))*energyG + (3.979703-((3.979703-4.020509)/(200.840594584407-176.850084449286))*200.840594584407);}
	else if ((energyG>=200.840594584407)&&(energyG<227.949870922697)){value=((4.044917-3.979703)/(227.949870922697-200.840594584407))*energyG + (4.044917-((4.044917-3.979703)/(227.949870922697-200.840594584407))*227.949870922697);}
	else if ((energyG>=227.949870922697)&&(energyG<258.583353055698)){value=((3.876639-4.044917)/(258.583353055698-227.949870922697))*energyG + (3.876639-((3.876639-4.044917)/(258.583353055698-227.949870922697))*258.583353055698);}
	else if ((energyG>=258.583353055698)&&(energyG<293.199187719917)){value=((3.962043-3.876639)/(293.199187719917-258.583353055698))*energyG + (3.962043-((3.962043-3.876639)/(293.199187719917-258.583353055698))*293.199187719917);}
	else if ((energyG>=293.199187719917)&&(energyG<332.315080725424)){value=((3.917244-3.962043)/(332.315080725424-293.199187719917))*energyG + (3.917244-((3.917244-3.962043)/(332.315080725424-293.199187719917))*332.315080725424);}
	else if ((energyG>=332.315080725424)&&(energyG<376.516039635127)){value=((3.928766-3.917244)/(376.516039635127-332.315080725424))*energyG + (3.928766-((3.928766-3.917244)/(376.516039635127-332.315080725424))*376.516039635127);}
	else if ((energyG>=376.516039635127)&&(energyG<426.463122992325)){value=((3.841409-3.928766)/(426.463122992325-376.516039635127))*energyG + (3.841409-((3.841409-3.928766)/(426.463122992325-376.516039635127))*426.463122992325);}
	else if ((energyG>=426.463122992325)&&(energyG<482.903326947793)){value=((3.917985-3.841409)/(482.903326947793-426.463122992325))*energyG + (3.917985-((3.917985-3.841409)/(482.903326947793-426.463122992325))*482.903326947793);}
	else if ((energyG>=482.903326947793)&&(energyG<546.680757148344)){value=((3.796317-3.917985)/(546.680757148344-482.903326947793))*energyG + (3.796317-((3.796317-3.917985)/(546.680757148344-482.903326947793))*546.680757148344);}
	else if ((energyG>=546.680757148344)&&(energyG<618.749252970851)){value=((3.857753-3.796317)/(618.749252970851-546.680757148344))*energyG + (3.857753-((3.857753-3.796317)/(618.749252970851-546.680757148344))*618.749252970851);}
	else if ((energyG>=618.749252970851)&&(energyG<700.186652906636)){value=((3.765587-3.857753)/(700.186652906636-618.749252970851))*energyG + (3.765587-((3.765587-3.857753)/(700.186652906636-618.749252970851))*700.186652906636);}
	else if ((energyG>=700.186652906636)&&(energyG<792.210914445748)){value=((3.749169-3.765587)/(792.210914445748-700.186652906636))*energyG + (3.749169-((3.749169-3.765587)/(792.210914445748-700.186652906636))*792.210914445748);}
	else if ((energyG>=792.210914445748)&&(energyG<896.198329546139)){value=((3.802904-3.749169)/(896.198329546139-792.210914445748))*energyG + (3.802904-((3.802904-3.749169)/(896.198329546139-792.210914445748))*896.198329546139);}
	else if ((energyG>=896.198329546139)&&(energyG<1013.70410811373)){value=((3.726969-3.802904)/(1013.70410811373-896.198329546139))*energyG + (3.726969-((3.726969-3.802904)/(1013.70410811373-896.198329546139))*1013.70410811373);}
	else {value=3.726969;}
	
	/*
    if(energyG<1)
    {
       value=1.0;
    }
    else
    {
        if(energyG<18.41975)
        {
            value=0.654271 + 0.465334*energyG -0.0361848*energyG*energyG+0.0010645*energyG*energyG*energyG;
        }
        else
        {
            if(energyG<200.84059)
            {
                value=2.84864 + 0.0242124*energyG -0.000169524*energyG*energyG + 3.81253e-07*energyG*energyG*energyG;
            }
            else
            {
                    value=4.13753 -0.000838656*energyG +6.4116e-07*energyG*energyG -1.97439e-10*energyG*energyG*energyG;
            }
        }
    }
	*/
	
    return value;
}
//////////////////////////////////////////////////////////

// added by Mattia ///////////////////////////////////////
G4double BremsstrahlungCorrection::ComputeCorrectionPWO_100(G4double eKineticEnergy)
{

    //calculate correction for cross section
    //  approximation from 0 to 1 TeV  by  polynomial
    G4double value=1;
    G4double energyG;

    energyG=eKineticEnergy/GeV;
	
	if (energyG<1.0){value=1.004436;}
	else if ((energyG>=1.00000000000000)&&(energyG<2.12999999523163)){value=((1.433864-1.004436)/(2.12999999523163-1.00000000000000))*energyG + (1.433864-((1.433864-1.004436)/(2.12999999523163-1.00000000000000))*2.12999999523163);}
	else if ((energyG>=2.12999999523163)&&(energyG<3.40689998445511)){value=((1.760973-1.433864)/(3.40689998445511-2.12999999523163))*energyG + (1.760973-((1.760973-1.433864)/(3.40689998445511-2.12999999523163))*3.40689998445511);}
	else if ((energyG>=3.40689998445511)&&(energyG<4.84979696618891)){value=((2.020183-1.760973)/(4.84979696618891-3.40689998445511))*energyG + (2.020183-((2.020183-1.760973)/(4.84979696618891-3.40689998445511))*4.84979696618891);}
	else if ((energyG>=4.84979696618891)&&(energyG<6.48027054866783)){value=((2.202800-2.020183)/(6.48027054866783-4.84979696618891))*energyG + (2.202800-((2.202800-2.020183)/(6.48027054866783-4.84979696618891))*6.48027054866783);}
	else if ((energyG>=6.48027054866783)&&(energyG<8.32270568909431)){value=((2.379030-2.202800)/(8.32270568909431-6.48027054866783))*energyG + (2.379030-((2.379030-2.202800)/(8.32270568909431-6.48027054866783))*8.32270568909431);}
	else if ((energyG>=8.32270568909431)&&(energyG<10.4046573889908)){value=((2.531378-2.379030)/(10.4046573889908-8.32270568909431))*energyG + (2.531378-((2.531378-2.379030)/(10.4046573889908-8.32270568909431))*10.4046573889908);}
	else if ((energyG>=10.4046573889908)&&(energyG<12.7572627999464)){value=((2.681182-2.531378)/(12.7572627999464-10.4046573889908))*energyG + (2.681182-((2.681182-2.531378)/(12.7572627999464-10.4046573889908))*12.7572627999464);}
	else if ((energyG>=12.7572627999464)&&(energyG<15.4157069031080)){value=((2.836381-2.681182)/(15.4157069031080-12.7572627999464))*energyG + (2.836381-((2.836381-2.681182)/(15.4157069031080-12.7572627999464))*15.4157069031080);}
	else if ((energyG>=15.4157069031080)&&(energyG<18.4197487270042)){value=((2.911952-2.836381)/(18.4197487270042-15.4157069031080))*energyG + (2.911952-((2.911952-2.836381)/(18.4197487270042-15.4157069031080))*18.4197487270042);}
	else if ((energyG>=18.4197487270042)&&(energyG<21.8143159736826)){value=((3.051848-2.911952)/(21.8143159736826-18.4197487270042))*energyG + (3.051848-((3.051848-2.911952)/(21.8143159736826-18.4197487270042))*21.8143159736826);}
	else if ((energyG>=21.8143159736826)&&(energyG<25.6501769462425)){value=((3.065907-3.051848)/(25.6501769462425-21.8143159736826))*energyG + (3.065907-((3.065907-3.051848)/(25.6501769462425-21.8143159736826))*25.6501769462425);}
	else if ((energyG>=25.6501769462425)&&(energyG<29.9846998269445)){value=((3.200765-3.065907)/(29.9846998269445-25.6501769462425))*energyG + (3.200765-((3.200765-3.065907)/(29.9846998269445-25.6501769462425))*29.9846998269445);}
	else if ((energyG>=29.9846998269445)&&(energyG<34.8827106614691)){value=((3.232915-3.200765)/(34.8827106614691-29.9846998269445))*energyG + (3.232915-((3.232915-3.200765)/(34.8827106614691-29.9846998269445))*34.8827106614691);}
	else if ((energyG>=34.8827106614691)&&(energyG<40.4174628811264)){value=((3.343544-3.232915)/(40.4174628811264-34.8827106614691))*energyG + (3.343544-((3.343544-3.232915)/(40.4174628811264-34.8827106614691))*40.4174628811264);}
	else if ((energyG>=40.4174628811264)&&(energyG<46.6717328629473)){value=((3.389615-3.343544)/(46.6717328629473-40.4174628811264))*energyG + (3.389615-((3.389615-3.343544)/(46.6717328629473-40.4174628811264))*46.6717328629473);}
	else if ((energyG>=46.6717328629473)&&(energyG<53.7390579125823)){value=((3.469390-3.389615)/(53.7390579125823-46.6717328629473))*energyG + (3.469390-((3.469390-3.389615)/(53.7390579125823-46.6717328629473))*53.7390579125823);}
	else if ((energyG>=53.7390579125823)&&(energyG<61.7251351849702)){value=((3.487987-3.469390)/(61.7251351849702-53.7390579125823))*energyG + (3.487987-((3.487987-3.469390)/(61.7251351849702-53.7390579125823))*61.7251351849702);}
	else if ((energyG>=61.7251351849702)&&(energyG<70.7494024646879)){value=((3.462476-3.487987)/(70.7494024646879-61.7251351849702))*energyG + (3.462476-((3.462476-3.487987)/(70.7494024646879-61.7251351849702))*70.7494024646879);}
	else if ((energyG>=70.7494024646879)&&(energyG<80.9468244477379)){value=((3.495850-3.462476)/(80.9468244477379-70.7494024646879))*energyG + (3.495850-((3.495850-3.462476)/(80.9468244477379-70.7494024646879))*80.9468244477379);}
	else if ((energyG>=80.9468244477379)&&(energyG<92.4699112399593)){value=((3.562907-3.495850)/(92.4699112399593-80.9468244477379))*energyG + (3.562907-((3.562907-3.495850)/(92.4699112399593-80.9468244477379))*92.4699112399593);}
	else if ((energyG>=92.4699112399593)&&(energyG<105.490999260223)){value=((3.587608-3.562907)/(105.490999260223-92.4699112399593))*energyG + (3.587608-((3.587608-3.562907)/(105.490999260223-92.4699112399593))*105.490999260223);}
	else if ((energyG>=105.490999260223)&&(energyG<120.204828661032)){value=((3.573588-3.587608)/(120.204828661032-105.490999260223))*energyG + (3.573588-((3.573588-3.587608)/(120.204828661032-105.490999260223))*120.204828661032);}
	else if ((energyG>=120.204828661032)&&(energyG<136.831455813785)){value=((3.585118-3.573588)/(136.831455813785-120.204828661032))*energyG + (3.585118-((3.585118-3.573588)/(136.831455813785-120.204828661032))*136.831455813785);}
	else if ((energyG>=136.831455813785)&&(energyG<155.619544417114)){value=((3.615233-3.585118)/(155.619544417114-136.831455813785))*energyG + (3.615233-((3.615233-3.585118)/(155.619544417114-136.831455813785))*155.619544417114);}
	else if ((energyG>=155.619544417114)&&(energyG<176.850084449286)){value=((3.612218-3.615233)/(176.850084449286-155.619544417114))*energyG + (3.612218-((3.612218-3.615233)/(176.850084449286-155.619544417114))*176.850084449286);}
	else if ((energyG>=176.850084449286)&&(energyG<200.840594584407)){value=((3.632248-3.612218)/(200.840594584407-176.850084449286))*energyG + (3.632248-((3.632248-3.612218)/(200.840594584407-176.850084449286))*200.840594584407);}
	else if ((energyG>=200.840594584407)&&(energyG<227.949870922697)){value=((3.596413-3.632248)/(227.949870922697-200.840594584407))*energyG + (3.596413-((3.596413-3.632248)/(227.949870922697-200.840594584407))*227.949870922697);}
	else if ((energyG>=227.949870922697)&&(energyG<258.583353055698)){value=((3.608850-3.596413)/(258.583353055698-227.949870922697))*energyG + (3.608850-((3.608850-3.596413)/(258.583353055698-227.949870922697))*258.583353055698);}
	else if ((energyG>=258.583353055698)&&(energyG<293.199187719917)){value=((3.626842-3.608850)/(293.199187719917-258.583353055698))*energyG + (3.626842-((3.626842-3.608850)/(293.199187719917-258.583353055698))*293.199187719917);}
	else if ((energyG>=293.199187719917)&&(energyG<332.315080725424)){value=((3.580544-3.626842)/(332.315080725424-293.199187719917))*energyG + (3.580544-((3.580544-3.626842)/(332.315080725424-293.199187719917))*332.315080725424);}
	else if ((energyG>=332.315080725424)&&(energyG<376.516039635127)){value=((3.613629-3.580544)/(376.516039635127-332.315080725424))*energyG + (3.613629-((3.613629-3.580544)/(376.516039635127-332.315080725424))*376.516039635127);}
	else if ((energyG>=376.516039635127)&&(energyG<426.463122992325)){value=((3.527474-3.613629)/(426.463122992325-376.516039635127))*energyG + (3.527474-((3.527474-3.613629)/(426.463122992325-376.516039635127))*426.463122992325);}
	else if ((energyG>=426.463122992325)&&(energyG<482.903326947793)){value=((3.535935-3.527474)/(482.903326947793-426.463122992325))*energyG + (3.535935-((3.535935-3.527474)/(482.903326947793-426.463122992325))*482.903326947793);}
	else if ((energyG>=482.903326947793)&&(energyG<546.680757148344)){value=((3.480323-3.535935)/(546.680757148344-482.903326947793))*energyG + (3.480323-((3.480323-3.535935)/(546.680757148344-482.903326947793))*546.680757148344);}
	else if ((energyG>=546.680757148344)&&(energyG<618.749252970851)){value=((3.467957-3.480323)/(618.749252970851-546.680757148344))*energyG + (3.467957-((3.467957-3.480323)/(618.749252970851-546.680757148344))*618.749252970851);}
	else if ((energyG>=618.749252970851)&&(energyG<700.186652906636)){value=((3.439801-3.467957)/(700.186652906636-618.749252970851))*energyG + (3.439801-((3.439801-3.467957)/(700.186652906636-618.749252970851))*700.186652906636);}
	else if ((energyG>=700.186652906636)&&(energyG<792.210914445748)){value=((3.460076-3.439801)/(792.210914445748-700.186652906636))*energyG + (3.460076-((3.460076-3.439801)/(792.210914445748-700.186652906636))*792.210914445748);}
	else if ((energyG>=792.210914445748)&&(energyG<896.198329546139)){value=((3.404773-3.460076)/(896.198329546139-792.210914445748))*energyG + (3.404773-((3.404773-3.460076)/(896.198329546139-792.210914445748))*896.198329546139);}
	else if ((energyG>=896.198329546139)&&(energyG<1013.70410811373)){value=((3.367253-3.404773)/(1013.70410811373-896.198329546139))*energyG + (3.367253-((3.367253-3.404773)/(1013.70410811373-896.198329546139))*1013.70410811373);}
	else {value=3.367253;}

    return value;
}
//////////////////////////////////////////////////////////

G4double BremsstrahlungCorrection::ComputeCorrectionW_111_electron(G4double eKineticEnergy)
{
    //calculate correction for cross section
    //  approximation from 0 to 1 TeV  by  polynomial
    G4double value=1;
    G4double energyG;

    energyG=eKineticEnergy/GeV;
    if(energyG<1)
    {
        value=1.0;
    }
    else
    {
        if(energyG<9.5)
        {
            value=2.47222 + 0.628284*energyG -0.0366603*energyG*energyG;
        }
        else
        {
            if(energyG<45)
            {
                value=4.66268 + 0.0633186*energyG -0.000729992*energyG*energyG;
            }
            else
            {
                value=6.1775 +3.65186e-05*energyG -4.19386e-06*energyG*energyG;
            }
        }
    }
    return value;
}
G4double BremsstrahlungCorrection::ComputeCorrectionW_111_positron(G4double eKineticEnergy)
{
    //calculate correction for cross section
    //  approximation from 0 to 1 TeV  by  polynomial
    G4double value=1;
    G4double energyG;

    energyG=eKineticEnergy/GeV;
    if(energyG<1)
    {
        value=1.0;
    }
    else
    {
        if(energyG<8.5)
        {
            value=0.449704 + 1.03147*energyG -0.0681459*energyG*energyG;
        }
        else
        {
            if(energyG<16)
            {
                value=1.25058 + 0.488534*energyG -0.0144321*energyG*energyG;
            }
            else
            {
                if(energyG<32)
                {
                    value=7.07627 -0.176846*energyG +0.00455684*energyG*energyG;
                }
                else
                {
                    value=5.99231 +0.00389363*energyG -1.67781e-05*energyG*energyG;
                }
            }
        }
    }
    return value;
}

G4double BremsstrahlungCorrection::ComputeCorrectionW_111_3mrad_electron(G4double eKineticEnergy)
{
    //calculate correction for cross section
    //  approximation from 0 to 1 TeV  by  polynomial
    G4double value=1;
    G4double energyG;

    energyG=eKineticEnergy/GeV;
    if(energyG<1)
    {
        value=1.0;
    }
    else
    {
        if(energyG<9.5)
        {
            value=1.82337 + 0.487443*energyG -0.0319659*energyG*energyG;
        }
        else
        {
            if(energyG<45)
            {
                value=3.72712 + 0.0177542*energyG -0.00016182*energyG*energyG;
            }
            else
            {
                value=4.33585 -0.00319053*energyG +5.56825e-07*energyG*energyG;
            }
        }
    }
    return value;
}
G4double BremsstrahlungCorrection::ComputeCorrectionW_111_3mrad_positron(G4double eKineticEnergy)
{
    //calculate correction for cross section
    //  approximation from 0 to 1 TeV  by  polynomial
    G4double value=1;
    G4double energyG;

    energyG=eKineticEnergy/GeV;
    if(energyG<1)
    {
        value=1.0;
    }
    else
    {
        if(energyG<8.5)
        {
            value=1.45762 + 0.614643*energyG -0.0411202*energyG*energyG;
        }
        else
        {
            if(energyG<16)
            {
                value=2.96736 + 0.114422*energyG -0.00297188*energyG*energyG;
            }
            else
            {
                if(energyG<32)
                {
                    value=2.83383 +0.108914*energyG -0.0022029*energyG*energyG;
                }
                else
                {
                    value=4.22193 -0.00195466*energyG -1.80209e-06*energyG*energyG;
                }
            }
        }
    }
    return value;
}
